\doxysection{Action potential}
\label{group__MODELING__SINGLE__AP}\index{Action potential@{Action potential}}
The \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} is one of the big mysteries of life. We put together isolating membrane, isolating membrane tubes connected to the membrane, voltage-\/controlled ion channels in their walls, and electrolyte solution around them. We apply currents/voltage levels or pulses to the tubes, and at some point (at some appropriate combination of parameters) the system starts to issue \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP}s\+: {\itshape the non-\/living matter turns to living matter}. This miracle of \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP}, in contrast with the expectations of Hodgkin and Huxley \cite{HodgkinHuxley:1952}, can be described from the first principles of physics when using the right physical \doxyref{approximations and abstractions}{p.}{group__PHYSICS__ABSTRACTION_PHYSICS_ABSTRACTIONS}.

Actually, neurons interface the living and the non-\/living components of nature. To understand the details of their respective operation, a very precise interpretation of notions and laws of non-\/living matter is also needed. Applying laws derived for an approximation abstracted for the conditions of classic science is misleading and prevents us understanding that at a different abstraction level they are living components and simultaneously, still they can be described by the laws of non-\/living science; provided that we use the right \doxyref{abstractions and approximations}{p.}{group__PHYSICS__ABSTRACTION_PHYSICS_ABSTRACTIONS} their case requires. They are studied by research methods and tools of fellow sciences and are described by the universal language of nature\+: mathematics. However, not necessarily by the mathematical procedures developed for other goals and used in classic science.

Despite the impressive advances in neuroscience during the passed decays, there are still \textquotesingle{}white spots\textquotesingle{}. \textquotesingle{}{\itshape Why} action potentials are initiated in the axon is still unclear\textquotesingle{} \cite{ActionPotentialGenerationNatrium:2008} and \char`\"{}we should not seek a special organ for \textquotesingle{}information storage\textquotesingle{} -\/-\/ it is stored, as it should be, in every circuit\char`\"{} \cite{SterlingPrinciples:2017}. This latter source points to the important point \textquotesingle{}Send only information that is needed, and {\itshape send it as slowly as possible}\textquotesingle{} \cite{SterlingPrinciples:2017}, because \textquotesingle{}Communication consumes 35 times more energy than computation\textquotesingle{}. \cite{EnergyNeuralCommunication:2021} One more point why {\itshape computation and communication must not be handled separately}. Opens also the questions {\itshape what is information, how it is stored, processed and transmitted}.

As we discussed in section \doxyref{about modeling neuronal membrane}{p.}{group__MODELING__SINGLE__MEMBRANE_MODELING_SINGLE_MEMBRANE}, we can model a neuron as a membrane that changes its potential above a resting potential, receives (gated) synaptic currents through its axons and through its ions channels, furthermore external currents/voltages provided by the experimenter. Those \doxyref{currents are slow}{p.}{group__PHYSICS__SLOW__CURRENT_PHYSICS_SLOW_CURRENT}, so we must consider their speed to produce the membrane\textquotesingle{}s correct behavior, either as a \doxyref{time delay}{p.}{group__PHYSICS__MEASURING__DELAY_PHYSICS_DELAY} or a time course of a current intensity.\doxysubsection{Modeling Action Potential}\label{group__MODELING__SINGLE__AP_MODELING_ACTION_POTENTIAL}
Because the ions (implementing the membrane current) are slow, the potential they create changes continuously, in the function of location and time. The \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} is forwarded through the axon using the voltage on the membrane. This means that to derive the time course of the action potential, we need to consider that the slow current reaches that place under a finite period.\doxysubsubsection{The conceptual model of Action Potential}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_CONCEPTUAL}
It is known that \char`\"{}the axon initial segment (\+AIS) is located at the proximal axon and is the site of action potential initiation\char`\"{}. Therefore describe \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} \char`\"{}as the action potential initiation site\char`\"{}, which should be understood that \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} is initiated by the neuron\textquotesingle{}s membrane and the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} mediates it to the axon. \char`\"{}\+After action potentials are generated, they propagate along axons to synaptic terminals\char`\"{} \cite{AxonInitialSegmentStructure:2018}. That is, from the point of view of electronics, we need to describe the output voltage that the circuit generates. For understanding {\itshape how} and {\itshape why} the \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} is initiated, see the discussion below.\doxysubsubsection{Stages of generating Action Potential}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_STAGES}
As the major tool of understanding neuronal operation is to establish theoretically its operating principle, in addition to the appropriately interpreted physics, we keep an eye on biological aspects of theoretical computing. As discussed in \cite{ThreeStateUnidirectional:2004} \cite{MarkovianIonChannel:2005}, for the adequate description of the operation of \doxyref{ion channels}{p.}{group__MODELING__SINGLE__ION__CHANNEL_MODELING_ION_CHANNEL}, the major components of neuronal computing, three-\/state systems must be used. (This in an important point when discussing \doxyref{the biological implementation of computing}{p.}{group__COMPUTING__BASICS_COMPUTING_BIOLOGY}.) In line with this theoretical requirement and the phenomena of physiologists, we divide the operation of creating \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP}s to three stages, based on whether the neuron membrane\textquotesingle{} voltage is above the threshold voltage (in stage \textquotesingle{}Delivering\textquotesingle{}) or below it; furthermore whether the potential approaches the threshold level in the raising direction corresponding to the (\textquotesingle{}Computing\textquotesingle{}) or falling (\textquotesingle{}Relaxing\textquotesingle{}) stage. Due to the presence of \doxyref{\textquotesingle{}slow currents\textquotesingle{}}{p.}{group__PHYSICS__SLOW__CURRENT_PHYSICS_SLOW_CURRENT}, the observation times and the observed phenomena are in delay compared to the events we define the transitions with. This delay needs explanation when mapping our time-\/aware subdivisions to the decades old, but only empirical subdivisions of physiology. (In the present two-\/state digital electronic logic systems, the rising and falling edge, plus the \textquotesingle{}hold\textquotesingle{} voltage also implement three stages, although the first two have very short periods. It is not known if such a third stage can be available among the quantum states at all.)

\label{group__MODELING__SINGLE__AP_fig_AP_Conceptual}%


 
\begin{figure}
\includegraphics[width=.4\textwidth]{images/AP_ConceptualDemo.pdf}
\caption{The conceptual diagram of a neuronal Action Potential}
\label{fig_AP_Conceptual}
\end{figure}


The conceptual figure clearly distinguishez there stages. It is relatively easy to create a corresponding state machine \doxyref{fig\+\_\+\+Neuron\+State\+Machine}{p.}{group__COMPUTING__BASICS_fig_NeuronStateMachine} (programmed in \doxyref{sc\+Gen\+Comp\+\_\+\+PU\+\_\+\+Abstract}{p.}{classscGenComp__PU__Abstract}). Some programming twists are needed, but basically those stages are implemented.\doxysubsubsection{Creating an AP}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_CREATING}
Figure \doxyref{fig\+\_\+\+AP\+\_\+\+Conceptual}{p.}{group__MODELING__SINGLE__AP_fig_AP_Conceptual} shows how we imagine conceptually the creation of an \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} (not considering the \doxyref{details of the physics behind the operation}{p.}{group__PHYSICS__ABSTRACTION_PHYSICS_ABSTRACTIONS}). The cell is the simplest organization with no complex higher-\/level control mechanism; it receives slow currents, finite-\/size semipermeable isolating membrane and ion channels in \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} to implement its operation. (these ion channels are not voltage-\/controlled, enabling to implement a \textquotesingle{}leaking current\textquotesingle{}, also in stage \textquotesingle{}Relaxing\textquotesingle{}.)

In line with the electronic implementation of the three states, the value of the membrane potential clearly marks the limits of the \textquotesingle{}Delivering\textquotesingle{} stage. In \textquotesingle{}Relaxing\textquotesingle{} stage, the synaptic inputs are enabled and the delivered charge increases membrane\textquotesingle{}s voltage, while a current through the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} continously decreases it. If integrating those current contributions is sufficient to increase the membrane\textquotesingle{}s potential above the threshold value, the neuron passes to the stage \textquotesingle{}Delivering\textquotesingle{}, where different physical processes must be considered. The gates work in a \doxyref{pulse-\/like way}{p.}{group__MODELING__SINGLE__ION__CHANNEL_MODELING_ION_CHANNEL}\+: they close in a short time and need crossing the threshold level again to be reopened. The excitation may also be unsuccessful, and after \textquotesingle{}Computing\textquotesingle{} the neuron returns to stage \textquotesingle{}Relaxing\textquotesingle{}. The cell uses different mechanisms to restore its state, and issuing an \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} is a great way to reach that goal. A neuron receives spikes (ion current packages) from its fellow neurons (or in the case of suffering external invasion, currents from the experimenter) and produces an output spike (a new ion package), nearly always the same form. It is important to understand that {\itshape a neuron does not forward or pass electric signals}\+: in receives one(s) and prepares a new one on its own.

When in stage \textquotesingle{}Relaxing\textquotesingle{} the excitation suceeds, an instant change happens\+: the ion channels in membrane\textquotesingle{}s wall open and in a very short time ions from the extracellular space rush in into the intracellular space, establishing stage \textquotesingle{}Delivery\textquotesingle{}. The ions diffuse in direction (in some sense, perpendicular to membrane\textquotesingle{}s surface) and the ions (due to the voltage gradient generated by the current outflow through the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS}) generate a \textquotesingle{}slow\textquotesingle{} current, flowing on the surface (in some sense, parellel with the surface). The process takes time (the speed of participating currents is in the range of 1 m/s, and the relevant distances inside the cell are up to 1 mm), so we can expect an electric charge processing time to be about 1 ms.

When ions from the most distant location also reach \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS}, no more increase is possible\+: the number of ions (and so\+: the current) starts to decrease, and consequently the voltage in the section in front of \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} starts to decrease. The overall voltage decrease over membrane\textquotesingle{}s surface reaches also neuronal arbors. As soon as the local voltage difference enables, delivering the synaptic charge packet continues\+: \textquotesingle{}the relative refractory\textquotesingle{} begins.

When the membrane feels that its deviation from its stable state sufficiently decreased (but still above the resting potential), it re-\/opens its synaptic inputs, but the neuron continues restoring its resting potential. Because the slow current is still on its way to \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS}, in line with the capacitive current of electronics, that current causes a hyperpolarized state (that voltage appears with a delay compared to when the voltage decreases below the critical level).

In its \textquotesingle{}Relaxing\textquotesingle{} stage, \doxyref{the neuron receives ions}{p.}{group__MODELING__SINGLE__ELECTRIC_MODELING_SINGLE_ELECTRIC} in some form (synaptic spikes, clamping or patching currents) that generate voltage change on the membrane. That voltage changes with the time and location. If it exceeds locally some threshold value, two complementary changes happen. The excess voltage opens the ion channels in the membrane\textquotesingle{}s walls, giving way to ions to rush-\/in from the extracellular space with much higher concentration into the intracellular space where they suddenly increase the membrane\textquotesingle{}s potential. The ions entering the intracellular space near the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} appear as current shortly after the ion channels open. That current steadily increases as ions from more distant locations also arrive, so the membrane voltage steadily increases.

At the same time, the ion inflow from the synaptic arbors stop. The simple mechanism is that the potential difference between the arbor and the membrane drives the ions. If the membrane\textquotesingle{}s potential exceeds that of the arbor, delivering the synaptic spike stops (the synapse becomes disabled during the \textquotesingle{}absolute refractory\textquotesingle{} period). The slow current continuously decreases the amount of the charge on the membrane\textquotesingle{}s surface, so the potential immediately in front of the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} reaches a peak value, then decreases below the resting potential, finally and slowly reaches the resting potential\+: it implements a kind of critically damped oscillation.\doxysubsubsection{Synaptic control}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_SYNAPTIC}
The ions arriving through the neuronal arbors simply cannot enter the membrane if membrane\textquotesingle{}s potential is above the threshold potential. This is observed that after (typically due to several adjacent input spikes) the {\texttt{ input spikes do not contribute anymore to membrane potential}} in the membrane\textquotesingle{}s chargeup phase but they are not any more diable if membrane potential drops below the threshold potential. In the latter case, the synaptic inputs get active again, the current flows into the membrane, but reaches \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} at some later time, depending on the distance of their junction point to the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS}. The inhibiton ends when the potential difference enables it, but its effect at the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} can be observed only later, given that the slow current needs time to travel from the junction point to the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS}.

Immediately after that the potential dropped below the threshold value (the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} is going toward the hyperpolarized state or going to reach its resting value), the incoming spikes will contribute to restoring the resting potential. Because of the effect of the {\itshape RC} circuit, their effect seems to be smaller if the potential change on the membrane heads toward hyperpolarizing the membrane, i.\+e., opposite with the potential increasing effect of the spike.\doxysubsubsection{Artificial charge input}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_ARTIFICIAL}
In the \textquotesingle{}natural\textquotesingle{} regime of neuronal operation, the charge arrives through the axons and physiology defines the current (shape and intensity). In the \textquotesingle{}artificial\textquotesingle{} regime, the current arrives either through an axon (clamping) or directly to the neuron\textquotesingle{}s body (patching). In this case, the experimental conditions define the shape (square wave, sine, or noise are the usual shapes) and the current intensity. Because of the \textquotesingle{}unnatural\textquotesingle{} charge input, analyzing the observations need special care.

The experimental circuits contain \doxyref{biological and electrical components}{p.}{group__MEASURING__ELECTROLYTES_MEASURING_ELECTROLITES_CLAMPING} and some gateways (electrolyte electrodes) convert the electrons to ions and vice versa. This conversion requires care when determining the voltage differences and timing of events.

Furthermore, it needs care when measuring timing differences.\doxysubsection{Variety of Action Potentials}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_VARIETY}
\label{group__MODELING__SINGLE__AP_AP_Variety}%


 
\begin{figure}
\includegraphics[width=.4\textwidth]{images/AP_Variety.png}
\caption{The variety of APs generated by our model}
\label{AP_Variety}
\end{figure}
\doxysubsubsection{Consequences of the concept}\label{group__MODELING__SINGLE__AP_MODELING_SINGLE_AP_CONSEQUENCES}
The slow current leads to some effects which are unexpected for the observer assuming instant interaction.


\begin{DoxyItemize}
\item The restarted synaptic current appears after the \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} with some phase delay\+: increase compared to the \textquotesingle{}normal\textquotesingle{} \doxyref{AP}{p.}{GLOSSARY_GLOSSARY_AP} shape can be measured at the time when the membrane is about being hyperpolarized.
\item Given that the driving force is the potential difference between the arbor and the membrane, the driven current also changes when the membrane\textquotesingle{}s voltage is around the threshold.\+It was observed that the same input is \char`\"{}less effective\char`\"{} when its effect reaches \doxyref{AIS}{p.}{GLOSSARY_GLOSSARY_AIS} at about the hyperpolarized state\+: while the potential difference is small after crossing the threshold voltage, less current flows into the membrane. (we also hypothesize the the voltage above the critical one drives some current in the reversed direction, from the membrane into the axonal arbor)
\item The the classic prompt current with the integrator-\/type oscillator cannot explain the hyperpolarized state itself. The \doxyref{slow current}{p.}{group__PHYSICS__SLOW__CURRENT_PHYSICS_SLOW_CURRENT} and the \doxyref{differentiator-\/type oscillator}{p.}{group__PHYSICS__MEASURING__OSCILLATOR_RCDifferentiatorCircuit} can.
\item The current in the reverse direction comprises not some newly created $K^+$ ions, it is simply a late (delayed) slow $Na^+$ ion current from the rushed-\/in ions. This current can correspond to the classic condenser current in the instant interaction picture, if we replace the erroneous parallel oscillator with the correct serial oscillator.
\item The membrane\textquotesingle{}s voltage after re-\/opening the axonal input may be above or below the resting potential, in this way it represents a short-\/term (in range of $1\ ms$) neuronal memory, that may combine the rest of the (temporarily suspended) \textquotesingle{}previous\textquotesingle{} spikes with the effect of (arrived during the absolute refractory period)\textquotesingle{}next\textquotesingle{} spikes.
\item The charge summation is not linear\+: the potential difference between the axonal arbor and the neuronal membrane changes the linearity. 
\end{DoxyItemize}